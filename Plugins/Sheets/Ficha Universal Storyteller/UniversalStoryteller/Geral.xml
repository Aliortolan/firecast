<?xml version="1.0" encoding="UTF-8"?>
<form name="frmGeral" align="client">
	<scrollBox align="client">
		<rectangle align="top" height="95" color="black" strokeColor="white" strokeSize="1" margins="{bottom=5}" padding="{top=5,bottom=5,left=5,right=5}">
			<rectangle align="left" width="200" color="black" strokeColor="white" strokeSize="1" margins="{right=5}">
				<image align="client" field="sistema" editable="true" style="proportional" margins="{left=2, right=2, top=2, bottom=2}">
					<event name="OnStartDrag">
						if drag then
					    	drag:addData("imageURL", sheet.sistema)
					    end
					</event>
				</image>
			</rectangle>

			<layout align="left" width="250" margins="{right=5}">
				<Header field="header0_0"/>
				<Header field="header0_1"/>
				<Header field="header0_2"/>
			</layout>

			<layout align="left" width="250" margins="{right=5}">
				<Header field="header1_0"/>
				<Header field="header1_1"/>
				<Header field="header1_2"/>
			</layout>

			<layout align="left" width="250" margins="{right=5}">
				<Header field="header2_0"/>
				<Header field="header2_1"/>
				<Header field="header2_2"/>
			</layout>
		</rectangle>

		<rectangle align="top" height="155" color="black" strokeColor="white" strokeSize="1" margins="{bottom=5}" padding="{top=5,bottom=5,left=5,right=5}">
	        <layout align="top" height="25" margins="{bottom=5}">
	            <formatEdit width="250" height="25" field="atributo" formatFloat=""/>
	            <button left="255" width="25" height="25" name="atributteButton">
	            	<image align="client" style="autoFit" src="images/gear.png"/>
	            	<event name="onClick">
	            		<![CDATA[
			    		local pop = self:findControlByName("popConfigAtr");
						
						if pop ~= nil then
							pop:setNodeObject(sheet);
							pop:showPopupEx("bottomCenter", self.atributteButton);
						else
							showMessage("Ops, bug.. nao encontrei o popup para exibir");
						end;
						]]>
	            	</event>
	            </button>
	        </layout>

	        <layout align="top" height="25" margins="{bottom=5}">
	        	<layout align="left" width="250" margins="{right=5}">
	            	<formatEdit width="250" height="25" field="atributo0" formatFloat=""/>
	            </layout>
	        	<layout align="left" width="250" margins="{right=5}">
	            	<formatEdit width="250" height="25" field="atributo1" formatFloat=""/>
	            </layout>
	        	<layout align="left" width="250" margins="{right=5}">
	            	<formatEdit width="250" height="25" field="atributo2" formatFloat=""/>
	            </layout>
	        </layout>

			<AttributeBox field="atributo0"/>
			<AttributeBox field="atributo1"/>
			<AttributeBox field="atributo2"/>

            <dataLink fields="{'atributo0Ini','atributo1Ini','atributo2Ini'}">
                <event name="onChange">
                    if sheet==nil then return end
                    sheet.atributoIni =   (tonumber(sheet.atributo0Ini) or 0) + 
                                            (tonumber(sheet.atributo1Ini) or 0) + 
                                            (tonumber(sheet.atributo2Ini) or 0)
                </event>
            </dataLink>
            <dataLink fields="{'atributo0Bonus','atributo1Bonus','atributo2Bonus'}">
                <event name="onChange">
                    if sheet==nil then return end
                    sheet.atributoBonus =   (tonumber(sheet.atributo0Bonus) or 0) + 
                                            (tonumber(sheet.atributo1Bonus) or 0) + 
                                            (tonumber(sheet.atributo2Bonus) or 0)
                </event>
            </dataLink>
		</rectangle>
	</scrollBox>
</form>